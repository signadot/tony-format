<!-- Comment 005 - 2025-12-20T11:06:31+01:00 -->

## The Tony Format Bible (docs/tony.md)

### Core Philosophy
- Tony is a dialect of YAML with improved ergonomics and safety through simplicity
- Valid JSON is valid Tony with no changes in semantics
- Fun fact: Tony is "ynot" backwards ("y notation")

### Key Features

**Atomic Types**
- JSON types: null, booleans, strings, numbers
- Literals: unquoted strings without whitespace, can't start with `[]{}: -!` or digits
- Block literals: `|` for multiline strings, works in bracketed mode too
- Single or double quotes with identical escaping grammar

**Collections**
- Arrays and mappings (JSON arrays and objects)
- Commas optional: `[1 2 3]` and `[1, 2, 3]` both valid
- Key sets: `{a b c}` = `{a: null, b: null, c: null}`
- Sparse arrays: integer-keyed maps for array diffs

**Tags**
- Local YAML tags: `!tag-name value`
- Tag composition: `!tovalue.file my-file.yaml`
- Tag arguments: `!tag(arg1,arg2)`
- Used for diffs, patches, and matching operations

**Normalization**
- Fixed 2-space indentation
- One degree of freedom: subtree may optionally be bracketed
- Wire format: bracketed style, no newlines
- Human format: readable with indentation

**Comments**
- `#` to end of line (no space required before `#`)
- Associated with preceding values and line comments

### String Merge Keys
```tony
spec:
  metadata:
    annotations:
      <<: |
        {{ range $k, $v := ... }}{{ $k | quote}}: {{ $v | quote -}} {{-end}}
```
Encode with `-x` to inject at indentation level (for Helm charts, etc.)
