<!-- Comment 001 - 2026-01-08T15:38:14+01:00 -->

## Minimal reproduction

```yaml
# build.tony
build:
  env:
    namespace: signadot
  sources:
  - dir: source/
  patches:
  # ============================================================
  # Webhook patches  
  # ============================================================
  # Add webhook port
  - match:
      kind: Deployment
      metadata:
        name: controller
    patch:
      spec:
        template:
          spec:
            containers: !key(name)
            - name: manager
              ports: !key(name)
              - containerPort: 9443
                name: webhook
  # ============================================================
  # CRD patch with dive
  # ============================================================
  - match:
      kind: CustomResourceDefinition
    patch:
      spec:
        versions: !dive
        - match:
            podTemplate: null
          patch:
            podTemplate:
              description: !delete null
              properties: !dive
              - match: !irtype {}
                patch:
                  description: !delete null
```

## Error

```
panic: runtime error: index out of range [0] with length 0

goroutine 1 [running]:
github.com/signadot/tony-format/go-tony/eval.ExpandIRWithOptions(...)
  .../eval/expand_env.go:258 +0x88c
```

Works without comments, seems related to comment association with `!dive` or `!key` operators.

