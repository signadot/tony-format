# Example logd session requests
# Usage: cat requests.tony | o system logd client localhost:9123
# Each non-comment line is a separate request in wire format

# --- HELLO (handshake - always first) ---

{hello: {clientId: "example-client"}}

# --- MATCH REQUESTS (reads) ---

# Read entire document at root
{match: {body: {path: ""}}}

# Read data at a specific path
{match: {body: {path: "users.alice"}}}

# --- PATCH REQUESTS (writes) ---

# Create/update a user
{patch: {path: "users.alice", data: {name: "Alice", email: "alice@example.com"}}}

# Update a nested field
{patch: {path: "users.alice.status", data: "active"}}

# Insert into an array using !insert
{patch: {path: "logs", data: !insert {timestamp: "2024-01-01T00:00:00Z", message: "hello"}}}

# Delete a field using !delete
{patch: {path: "users.alice.temp_token", data: !delete null}}

# --- WATCH REQUESTS (subscriptions) ---

# Watch a path for changes
{watch: {path: "users", fromCommit: 0}}

# Unwatch a path
{unwatch: {path: "users"}}

# --- TRANSACTIONS (multi-participant coordination) ---

# Create a new transaction with 2 participants
{newtx: {participants: 2}}

# Patch with transaction ID (response includes txId to use)
# {patch: {txId: 123, path: "orders.order-1", data: {status: "shipped"}}}
